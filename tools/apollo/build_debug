# WARNING: do not run this script without defining THREADS!
# If THREADS isn't defined then this script will call 'make -j'.
# From the manpage: "If the  -j  option is given without an argument, make will not limit the number of jobs that can run simultaneously."
# That means that the whole build will be started simultaneously and IT WILL CRASH YOUR COMPUTER!

cd ../..

TIMEOUT=600 ./init
bash -c "doxygen Doxyfile >/dev/null 2>/dev/null"

cd build
cmake -DTOOLS=ON ..
TIMEOUT=1000 make -j$THREADS

cd ..
mkdir build_release
cd build_release

cmake -DCMAKE_BUILD_TYPE=release ..
TIMEOUT=1000 make -j$THREADS memgraph_link_target memgraph__macro_benchmark memgraph__stress

# Install tools, because they may be needed to run some benchmarks and tests.
cd ../tools
./setup

cd apollo
./generate debug
